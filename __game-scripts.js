var Controller=pc.createScript("controller");Controller.attributes.add("speed",{type:"number",default:.09}),Controller.prototype.initialize=function(){var t=this.app,e=t.root.findByName("Camera");this.buttonForward=t.root.findByName("ButtonForward"),this.buttonBack=t.root.findByName("ButtonBack"),this.buttonRight=t.root.findByName("ButtonRight"),this.buttonLeft=t.root.findByName("ButtonLeft"),this.cameraScript=e.script.cameraMovement},Controller.worldDirection=new pc.Vec3,Controller.tempDirection=new pc.Vec3,Controller.prototype.update=function(t){var e=this.app,r=Controller.worldDirection;r.set(0,0,0);var o=Controller.tempDirection,i=this.entity.forward,a=this.entity.right,n=0,s=0;if((e.keyboard.isPressed(pc.KEY_A)||this.buttonLeft.pressed)&&(n-=1),(e.keyboard.isPressed(pc.KEY_D)||this.buttonRight.pressed)&&(n+=1),(e.keyboard.isPressed(pc.KEY_W)||this.buttonForward.pressed)&&(s+=1),(e.keyboard.isPressed(pc.KEY_S)||this.buttonBack.pressed)&&(s-=1),0!==n||0!==s){r.add(o.copy(i).mulScalar(s)),r.add(o.copy(a).mulScalar(n)),r.normalize();var d=new pc.Vec3(r.x*t,0,r.z*t);d.normalize().scale(this.speed),d.add(this.entity.getPosition());var c=this.cameraScript.eulers.x+180,p=new pc.Vec3(0,c,0);this.entity.rigidbody.teleport(d,p)}};var CameraMovement=pc.createScript("cameraMovement");CameraMovement.attributes.add("mouseSpeed",{type:"number",default:1.4,description:"Mouse Sensitivity"}),CameraMovement.prototype.initialize=function(){this.eulers=new pc.Vec3,this.touchCoords=new pc.Vec2;var e=this.app;e.mouse.on("mousemove",this.onMouseMove,this),e.mouse.on("mousedown",this.onMouseDown,this),this.rayEnd=e.root.findByName("CameraPosition"),this.on("destroy",(function(){e.mouse.off("mousemove",this.onMouseMove,this),e.mouse.off("mousedown",this.onMouseDown,this)}),this)},CameraMovement.prototype.postUpdate=function(e){var t=this.entity,o=t.parent,s=this.eulers.x+180,i=this.eulers.y,n=new pc.Vec3(-i,s,0);o.setEulerAngles(n),t.setPosition(this.getWorldPoint()),t.lookAt(o.getPosition())},CameraMovement.prototype.onMouseMove=function(e){pc.Mouse.isPointerLocked()&&(this.eulers.x-=this.mouseSpeed*e.dx/60%360,this.eulers.y+=this.mouseSpeed*e.dy/60%360,this.eulers.x<0&&(this.eulers.x+=360),this.eulers.y<0&&(this.eulers.y+=360))},CameraMovement.prototype.onMouseDown=function(e){this.app.mouse.enablePointerLock()},CameraMovement.prototype.getWorldPoint=function(){var e=this.entity.parent.getPosition(),t=this.rayEnd.getPosition(),o=this.app.systems.rigidbody.raycastFirst(e,t);return o?o.point:t};var ButtonClick=pc.createScript("ButtonClick");ButtonClick.prototype.initialize=function(){this.entity.pressed=!1,this.entity.button.on("pressedstart",(function(t){this.entity.pressed=!0}),this),this.entity.button.on("pressedend",(function(t){this.entity.pressed=!1}),this)},ButtonClick.prototype.update=function(t){};